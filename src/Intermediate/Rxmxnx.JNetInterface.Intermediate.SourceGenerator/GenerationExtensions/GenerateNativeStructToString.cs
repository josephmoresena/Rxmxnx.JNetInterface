using System;

using Microsoft.CodeAnalysis;

namespace Rxmxnx.JNetInterface.SourceGenerator;

internal static partial class GenerationExtensions
{
	private const String nativeToStringFormat = @"#nullable enable
// <auto-generated/>
namespace {0};

partial struct {1} 
{{
    /// <inheritdoc/>
    public override String ToString() => INative.ToString(this);
}}
#nullable restore";

	/// <summary>
	/// Generates overrides for <see cref="Object.ToString()"/> for natives structures.
	/// </summary>
	/// <param name="nativeSymbol">A type symbol of native structure.</param>
	/// <param name="context">Generation context.</param>
	public static void GenerateNativeStructToString(this ISymbol nativeSymbol, GeneratorExecutionContext context)
	{
		context.AddSource($"{nativeSymbol.Name}.ToString.g.cs",
		                  String.Format(GenerationExtensions.nativeToStringFormat, nativeSymbol.ContainingNamespace,
		                                nativeSymbol.Name));
	}
}